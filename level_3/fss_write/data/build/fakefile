# fss-0005 iki-0002
#
# Builds the fss_write library and all programs.
#
# An optional "install" is provided as a convience and a sort of documentation.
# This "install" only provides a very basic setup and it is strongly recommended to install manually or through some other means.
#

settings:
  fail exit

  environment PATH LD_LIBRARY_PATH

main:
  if parameter mode
    operate using_mode
  else
    operate using_default

using_default:
  build settings
  build settings.main
  build settings.basic
  build settings.basic_list
  build settings.extended
  build settings.extended_list
  build settings.embedded_list
  build settings.payload

using_mode:
  build settings parameter:'mode:value'
  build settings.main parameter:'mode:value'
  build settings.basic parameter:'mode:value'
  build settings.basic_list parameter:'mode:value'
  build settings.extended parameter:'mode:value'
  build settings.extended_list parameter:'mode:value'
  build settings.embedded_list parameter:'mode:value'
  build settings.payload parameter:'mode:value'

install:
  shell ./install.sh parameter:'work'
  shell ./install.sh parameter:'work' -s data/build/settings.main
  shell ./install.sh parameter:'work' -s data/build/settings.basic
  shell ./install.sh parameter:'work' -s data/build/settings.basic_list
  shell ./install.sh parameter:'work' -s data/build/settings.extended
  shell ./install.sh parameter:'work' -s data/build/settings.extended_list
  shell ./install.sh parameter:'work' -s data/build/settings.embedded_list
  shell ./install.sh parameter:'work' -s data/build/settings.payload
