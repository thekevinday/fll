# fss-0002

main:
  chain INPUT
  device all
  direction none

  # Log everything else (input)
  # everything that reaches this point without being accepted, reject, or otherwise handled will be logged
  rule -m state --state NEW -j LOG --log-prefix "FIREWALL:INPUT "

  chain OUTPUT

  ## Log everything else (output)
  #rule -j LOG --log-prefix "FIREWALL:OUTPUT "

  # the catch-all policies
  action policy
  chain INPUT
  rule DROP

  chain OUTPUT
  rule DROP

  chain FORWARD
  rule DROP


input-tcp:
  direction output
  protocol tcp

  ## allow Well-known port output: 0-1023
  #rule --dport 0:1023 -m state --state NEW -j ACCEPT

  ## allow registered ports: 1024-49151
  #rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  ## allow all other ports: 49152-61000
  #rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  ## allow all other ports: 61001-65535
  #rule --dport 61001:65535 -m state --state NEW -j ACCEPT


output-tcp:
  direction output
  protocol tcp

  # allow Well-known port output: 0-1023
  rule --dport 0:1023 -m state --state NEW -j ACCEPT

  # allow registered ports: 1024-49151
  rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  # allow all other ports: 49152-61000
  rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  # allow all other ports: 61001-65535
  rule --dport 61001:65535 -m state --state NEW -j ACCEPT


input-udp:
  direction input
  protocol udp

  ## allow Well-known port output: 0-1023
  #rule --dport 0:1023 -m state --state NEW -j ACCEPT

  ## allow registered ports: 1024-49151
  #rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  ## allow all other ports: 49152-61000
  #rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  ## allow all other ports: 61001-65535
  #rule --dport 61001:65535 -m state --state NEW -j ACCEPT


output-udp:
  direction output
  protocol udp

  # allow Well-known port output: 0-1023
  rule --dport 0:1023 -m state --state NEW -j ACCEPT

  # allow registered ports: 1024-49151
  rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  # allow all other ports: 49152-61000
  rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  # allow all other ports: 61001-65535
  rule --dport 61001:65535 -m state --state NEW -j ACCEPT


input-icmp:
  direction input


  # ipv4 icmp
  tool iptables
  protocol icmp

  # allow all icmp input, such as pings
  #rule -m state --state NEW -j ACCEPT

  # allow icmp: echo reply (outbound ping)
  #rule --icmp-type 0 -m state --state NEW -j ACCEPT

  # allow icmp: destination unreachable
  rule --icmp-type 3 -m state --state NEW -j ACCEPT

  # deny icmp: source quench (deprecated and should be blocked.)
  rule --icmp-type 4 -m state --state NEW -j DROP

  # allow icmp: redirect
  rule --icmp-type 5 -m state --state NEW -j ACCEPT

  # deny icmp: Alternate Host Address (deprecated and should be blocked.)
  rule --icmp-type 6 -m state --state NEW -j DROP

  # deny icmp: unknown
  rule --icmp-type 7 -m state --state NEW -j DROP

  # allow icmp: echo request (inbound ping)
  rule --icmp-type 8 -m state --state NEW -j ACCEPT

  # allow icmp: router advertisement
  rule --icmp-type 9 -m state --state NEW -j ACCEPT

  # allow icmp: router Solicitation
  rule --icmp-type 10 -m state --state NEW -j ACCEPT

  # allow icmp: time exceeded
  rule --icmp-type 11 -m state --state NEW -j ACCEPT

  # allow icmp: bad ip header
  rule --icmp-type 12 -m state --state NEW -j ACCEPT

  # allow icmp: timestamp
  rule --icmp-type 13 -m state --state NEW -j ACCEPT

  # allow icmp: timestamp reply
  rule --icmp-type 14 -m state --state NEW -j ACCEPT

  # deny icmp: information request (deprecated and should be blocked.)
  rule --icmp-type 15 -m state --state NEW -j DROP

  # deny icmp: information reply (deprecated and should be blocked.)
  rule --icmp-type 16 -m state --state NEW -j DROP

  # deny icmp: address request (deprecated and should be blocked.)
  rule --icmp-type 17 -m state --state NEW -j DROP

  # deny icmp: address reply (deprecated and should be blocked.)
  rule --icmp-type 18 -m state --state NEW -j DROP

  # deny icmp: unknown (19 throught 29)
  #rule --icmp-type 19 -m state --state NEW -j DROP

  # allow icmp: traceroute
  #rule --icmp-type 30 -m state --state NEW -j ACCEPT

  # deny icmp: unknown (31 throught 39) (deprecated and should be blocked.)
  rule --icmp-type 31 -m state --state NEW -j DROP


  # ipv6 icmp
  tool ip6tables
  protocol icmpv6

  # allow all icmp input
  #rule -m state --state NEW -j ACCEPT

  # destination uncreachable
  rule --icmpv6-type 1 -m state --state NEW -j ACCEPT

  # packet too big
  rule --icmpv6-type 2 -m state --state NEW -j ACCEPT

  # time exceeded
  rule --icmpv6-type 3 -m state --state NEW -j ACCEPT

  # parameter problem
  rule --icmpv6-type 4 -m state --state NEW -j ACCEPT

  # Private experimentation
  #rule --icmpv6-type 100 -m state --state NEW -j ACCEPT
  #rule --icmpv6-type 101 -m state --state NEW -j ACCEPT

  # echo request
  rule --icmpv6-type 128 -m state --state NEW -j ACCEPT

  # echo reply
  #rule --icmpv6-type 129 -m state --state NEW -j ACCEPT

  # multiclass listener
  rule --icmpv6-type 130 -m state --state NEW -j ACCEPT

  # multiclass listener report
  rule --icmpv6-type 131 -m state --state NEW -j ACCEPT

  # multiclass listener done
  rule --icmpv6-type 132 -m state --state NEW -j ACCEPT

  # router solicitation
  rule --icmpv6-type 133 -m state --state NEW -j ACCEPT

  # router advertisement
  rule --icmpv6-type 134 -m state --state NEW -j ACCEPT

  # neighbor solicitation
  rule --icmpv6-type 135 -m state --state NEW -j ACCEPT

  # neighbor advertisement
  rule --icmpv6-type 136 -m state --state NEW -j ACCEPT

  # redirect messages
  rule --icmpv6-type 137 -m state --state NEW -j ACCEPT

  # router renumbering
  rule --icmpv6-type 138 -m state --state NEW -j ACCEPT

  # icmp node information query
  rule --icmpv6-type 139 -m state --state NEW -j ACCEPT

  # icmp node information response
  rule --icmpv6-type 140 -m state --state NEW -j ACCEPT

  # inverse neighbor discoverey solicitation message
  rule --icmpv6-type 141 -m state --state NEW -j ACCEPT

  # inverse neighbor discoverey advertisement message
  rule --icmpv6-type 142 -m state --state NEW -j ACCEPT

  # multicast listener discovery reports
  rule --icmpv6-type 143 -m state --state NEW -j ACCEPT

  # home agent address discovery request message
  rule --icmpv6-type 144 -m state --state NEW -j ACCEPT

  # home agent address discovery reply message
  rule --icmpv6-type 145 -m state --state NEW -j ACCEPT

  # mobile prefix solicitation
  rule --icmpv6-type 146 -m state --state NEW -j ACCEPT

  # mobile prefix advertisement
  rule --icmpv6-type 147 -m state --state NEW -j ACCEPT

  # certification path solicitation
  rule --icmpv6-type 148 -m state --state NEW -j ACCEPT

  # certification path advertisement
  rule --icmpv6-type 149 -m state --state NEW -j ACCEPT

  # used by experimental protocol
  #rule --icmpv6-type 150 -m state --state NEW -j ACCEPT

  # multicast router solicitation
  rule --icmpv6-type 151 -m state --state NEW -j ACCEPT

  # multicast router advertisement
  rule --icmpv6-type 152 -m state --state NEW -j ACCEPT

  # multicast router termination
  rule --icmpv6-type 153 -m state --state NEW -j ACCEPT

  # fmipv6 control messages
  rule --icmpv6-type 154 -m state --state NEW -j ACCEPT

  # rpl control messages
  rule --icmpv6-type 155 -m state --state NEW -j ACCEPT

  # private experimentation
  #rule --icmpv6-type 200 -m state --state NEW -j ACCEPT
  #rule --icmpv6-type 201 -m state --state NEW -j ACCEPT


output-icmp:
  direction output
  protocol icmp


  # ipv4 icmp
  tool iptables
  protocol icmp

  # allow icmp output, such as pings
  rule -m state --state NEW -j ACCEPT


  # ipv6 icmp
  tool ip6tables
  protocol icmpv6

  # allow icmp output, such as pings
  rule -m state --state NEW -j ACCEPT
