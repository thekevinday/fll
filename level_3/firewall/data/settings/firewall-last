# fss-0002

main:
  direction input

  # Log everything else (input)
  # everything that reaches this point without being accepted, reject, or otherwise handled will be logged
  rule -m state --state NEW -j LOG --log-prefix "FIREWALL:INPUT "

  direction output

  ## Log everything else (output)
  #rule -j LOG --log-prefix "FIREWALL:OUTPUT "

  # the catch-all policies
  action policy
  direction input
  rule DROP

  direction output
  rule DROP

  direction forward
  rule DROP


input-tcp:
  direction output
  protocol tcp

  ## allow Well-known port output: 0-1023
  #rule --dport 0:1023 -m state --state NEW -j ACCEPT

  ## allow registered ports: 1024-49151
  #rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  ## allow all other ports: 49152-61000
  ## For ease of the uneducated, enable these by default
  #rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  ## allow all other ports: 61001-65535
  ## For ease of the uneducated, enable these by default
  #rule --dport 61001:65535 -m state --state NEW -j ACCEPT


output-tcp:
  direction output
  protocol tcp

  # allow Well-known port output: 0-1023
  rule --dport 0:1023 -m state --state NEW -j ACCEPT

  # allow registered ports: 1024-49151
  rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  # allow all other ports: 49152-61000
  # For ease of the uneducated, enable these by default
  rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  # allow all other ports: 61001-65535
  # For ease of the uneducated, enable these by default
  rule --dport 61001:65535 -m state --state NEW -j ACCEPT


input-udp:
  direction input
  protocol udp

  ## allow Well-known port output: 0-1023
  #rule --dport 0:1023 -m state --state NEW -j ACCEPT

  ## allow registered ports: 1024-49151
  #rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  ## allow all other ports: 49152-61000
  ## For ease of the uneducated, enable these by default
  #rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  ## allow all other ports: 61001-65535
  ## For ease of the uneducated, enable these by default
  #rule --dport 61001:65535 -m state --state NEW -j ACCEPT


output-udp:
  direction output
  protocol udp

  # allow Well-known port output: 0-1023
  rule --dport 0:1023 -m state --state NEW -j ACCEPT

  # allow registered ports: 1024-49151
  rule --dport 1024:49151 -m state --state NEW -j ACCEPT

  # allow all other ports: 49152-61000
  # For ease of the uneducated, enable these by default
  rule --dport 49152:61000 -m state --state NEW -j ACCEPT

  # allow all other ports: 61001-65535
  # For ease of the uneducated, enable these by default
  rule --dport 61001:65535 -m state --state NEW -j ACCEPT


input-icmp:
  direction input
  protocol icmp

  # allow all icmp input, such as pings
  #rule -m state --state NEW -j ACCEPT

  # ip6tables does not support --icmp-type with its icmp packets
  tool iptables

  # allow icmp: echo reply (outbound ping)
  #rule --icmp-type 0 -m state --state NEW -j ACCEPT

  # allow icmp: destination unreachable
  rule --icmp-type 3 -m state --state NEW -j ACCEPT

  # allow icmp: source quench
  rule --icmp-type 4 -m state --state NEW -j ACCEPT

  # allow icmp: redirect
  rule --icmp-type 5 -m state --state NEW -j ACCEPT

  # allow icmp: echo request (inbound ping)
  rule --icmp-type 8 -m state --state NEW -j ACCEPT

  # allow icmp: router advertisement
  rule --icmp-type 9 -m state --state NEW -j ACCEPT

  # allow icmp: router Solicitation
  rule --icmp-type 10 -m state --state NEW -j ACCEPT

  # allow icmp: time exceeded
  rule --icmp-type 11 -m state --state NEW -j ACCEPT

  # allow icmp: bad ip header
  rule --icmp-type 12 -m state --state NEW -j ACCEPT

  # allow icmp: timestamp
  rule --icmp-type 13 -m state --state NEW -j ACCEPT

  # allow icmp: timestamp reply
  rule --icmp-type 14 -m state --state NEW -j ACCEPT

  # allow icmp: information request
  rule --icmp-type 15 -m state --state NEW -j ACCEPT

  # allow icmp: information reply
  rule --icmp-type 16 -m state --state NEW -j ACCEPT

  # allow icmp: address request
  rule --icmp-type 17 -m state --state NEW -j ACCEPT

  # allow icmp: address reply
  rule --icmp-type 18 -m state --state NEW -j ACCEPT

  # allow icmp: traceroute
  #rule --icmp-type 30 -m state --state NEW -j ACCEPT


output-icmp:
  direction output
  protocol icmp

  # allow icmp output, such as pings
  rule -m state --state NEW -j ACCEPT
