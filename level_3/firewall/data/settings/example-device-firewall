# fss-0002

main:
  device this
  direction input

  # Define a blacklist and a whitelist, put ip addresses in the file named 'example-device-whitelist' separated by whitespace to whitelist an ip address
  #ip_list source example-device-whitelist -j ACCEPT
  #ip_list source example-device-blacklist -j REJECT
  #ip_list destination example-device-whitelist -j ACCEPT
  #ip_list destination example-device-blacklist -j REJECT


input-tcp:
  device this
  direction input
  protocol tcp

  ## Http / Web
  #rule --dport 80 -m state --state NEW -j LOG --log-prefix "TRAFFIC:WEB "
  #rule --dport 80 -m state --state NEW -j ACCEPT

  ## Http / Web redirect to Https / Secure Web
  #direction prerouting-input
  #rule -t nat --dport 80 -m state --state NEW -j REDIRECT --to-port 443
  #direction input

  ## Https / Secure Web
  #rule --dport 443 -m state --state NEW -j LOG --log-prefix "TRAFFIC:WEB "
  #rule --dport 443 -m state --state NEW -j ACCEPT

  ## MySQL
  #rule --dport 3306 -m state --state NEW -j ACCEPT

  ## Music Player Daemon
  #rule --dport 6600 -m state --state NEW -j ACCEPT

  ## Camsource
  #rule --dport 9192 -m state --state NEW -j ACCEPT

  ## Cups Printer Administration
  #rule --dport 631 -m state --state NEW -j ACCEPT

  ## Ssh (OpenSSH)
  #rule --dport 22 -m state --state NEW -j LOG --log-prefix "TRAFFIC:SSH "
  #rule --dport 22 -m state --state NEW -j ACCEPT

  ## clamd (Clam Antivirus) - remote access, not needed for normal
  #rule --dport 3310 -m state --state NEW -j ACCEPT

  ## Virtual Network Client Server (add 1 for each seperat vnc server)
  #rule --dport 5900 -m state --state NEW -j ACCEPT

  ## Printer Port, is probably open...safer to close unless you are SERVING a printer
  #rule --dport 515 -m state --state NEW -j REJECT

  ## Subversion server
  #rule --dport 3690 -m state --state NEW -j ACCEPT

  ## Silc server
  #rule --dport 706 -m state --state NEW -j ACCEPT

  ## Worms of Prey
  #rule --dport 47288 -m state --state NEW -j ACCEPT

  ## Git Daemon
  #rule --dport 9418 -m state --state NEW -j ACCEPT


input-udp:
  device this
  direction input
  protocol udp

  ## DNS Server (Bind or Maradns) (zoneserver from maradns does this portion)
  #rule --dport 53 -m state --state NEW -j ACCEPT

  ## DHCP Server
  #rule -m state --state NEW --dport 67 --sport 68 -j ACCEPT
  #rule -m state --state NEW --dport 68 --sport 67 -j ACCEPT

  ## Subversion server
  #rule --dport 3690 -m state --state NEW -j ACCEPT

  ## Worms of Prey
  #rule --sport 47288:47544 -m state --state NEW -j ACCEPT
  #rule --dport 47288:47544 -m state --state NEW -j ACCEPT


input-icmp:
  device this
  direction input
  protocol icmp

  # allow all icmp input, such as pings
  #rule -m state --state NEW -j ACCEPT

  # allow icmp: echo reply (outbound ping)
  ##rule --icmp-type 0 -m state --state NEW -j ACCEPT

  # allow icmp: destination unreachable
  #rule --icmp-type 3 -m state --state NEW -j ACCEPT

  # allow icmp: source quench
  #rule --icmp-type 4 -m state --state NEW -j ACCEPT

  # allow icmp: redirect
  #rule --icmp-type 5 -m state --state NEW -j ACCEPT

  # allow icmp: echo request (inbound ping)
  #rule --icmp-type 8 -m state --state NEW -j ACCEPT

  # allow icmp: router advertisement
  #rule --icmp-type 9 -m state --state NEW -j ACCEPT

  # allow icmp: router Solicitation
  #rule --icmp-type 10 -m state --state NEW -j ACCEPT

  # allow icmp: time exceeded
  #rule --icmp-type 11 -m state --state NEW -j ACCEPT

  # allow icmp: bad ip header
  #rule --icmp-type 12 -m state --state NEW -j ACCEPT

  # allow icmp: timestamp
  #rule --icmp-type 13 -m state --state NEW -j ACCEPT

  # allow icmp: timestamp reply
  #rule --icmp-type 14 -m state --state NEW -j ACCEPT

  # allow icmp: information request
  #rule --icmp-type 15 -m state --state NEW -j ACCEPT

  # allow icmp: information reply
  #rule --icmp-type 16 -m state --state NEW -j ACCEPT

  # allow icmp: address request
  #rule --icmp-type 17 -m state --state NEW -j ACCEPT

  # allow icmp: address reply
  #rule --icmp-type 18 -m state --state NEW -j ACCEPT

  # allow icmp: traceroute
  #rule --icmp-type 30 -m state --state NEW -j ACCEPT


output-tcp:
  device this
  direction output
  protocol tcp


output-udp:
  device this
  direction output
  protocol udp

  ## DNS Server (Bind or Maradns) (zoneserver from maradns does this portion)
  #rule --dport 53 -m state --state NEW -j ACCEPT

  ## DHCP Server
  #rule -m state --state NEW --dport 67 --sport 68 -j ACCEPT


output-icmp:
  device this
  direction output
  protocol icmp


